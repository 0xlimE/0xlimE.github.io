<!doctype html> <html lang="en-US"> <head>     <meta charset="UTF-8">     <meta name="viewport" content="width=device-width, initial-scale=1">     <link rel="profile" href="https://gmpg.org/xfn/11">  	<title>De Danske Cybermesterskaber Nationals &#8211; Ethereum Haiku &#8211; 0xlimE Writeup blog</title> <meta name='robots' content='max-image-preview:large' /> <link rel='dns-prefetch' href='//s.w.org' /> <link href='https://fonts.gstatic.com' crossorigin rel='preconnect' /> <link rel="alternate" type="application/rss+xml" title="0xlimE Writeup blog &raquo; Feed" href="https://0xli.me/?feed=rss2" /> <link rel="alternate" type="application/rss+xml" title="0xlimE Writeup blog &raquo; Comments Feed" href="https://0xli.me/?feed=comments-rss2" /> 		<script>
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/0xli.me\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.8.2"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script> 		<style> img.wp-smiley, img.emoji { 	display: inline !important; 	border: none !important; 	box-shadow: none !important; 	height: 1em !important; 	width: 1em !important; 	margin: 0 .07em !important; 	vertical-align: -0.1em !important; 	background: none !important; 	padding: 0 !important; } </style> 	<link rel='stylesheet' id='wp-block-library-css'  href='./css/dist-block-library-style.min.css' media='all' /> <link rel='stylesheet' id='wp_meliora-style-css'  href='./css/wp-meliora-style.css' media='all' /> <link rel='stylesheet' id='dashicons-css'  href='./css/c28-dashicons.min.css' media='all' /> <link rel='stylesheet' id='enlighterjs-css'  href='./css/enlighter-cache-enlighterjs.min.css' media='all' />         <script>
            /* <![CDATA[ */
            var rcewpp = {
                "ajax_url":"https://0xli.me/wp-admin/admin-ajax.php",
                "nonce": "34564bfd5b",
                "home_url": "https://0xli.me/",
                "settings_icon": 'https://0xli.me/wp-content/plugins/export-wp-page-to-static-html/admin/images/settings.png',
                "settings_hover_icon": 'https://0xli.me/wp-content/plugins/export-wp-page-to-static-html/admin/images/settings_hover.png'
            };
            /* ]]\> */
        </script>         <link rel="https://api.w.org/" href="https://0xli.me/index.php?rest_route=/" /><link rel="alternate" type="application/json" href="https://0xli.me/index.php?rest_route=/wp/v2/pages/710" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://0xli.me/xmlrpc.php?rsd" /> <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://0xli.me/wp-includes/wlwmanifest.xml" />  <meta name="generator" content="WordPress 5.8.2" /> <link rel="canonical" href="https://0xli.me/?page_id=710" /> <link rel='shortlink' href='https://0xli.me/?p=710' /> <link rel="alternate" type="application/json+oembed" href="https://0xli.me/index.php?rest_route=%2Foembed%2F1.0%2Fembed&#038;url=https%3A%2F%2F0xli.me%2F%3Fpage_id%3D710" /> <link rel="alternate" type="text/xml+oembed" href="https://0xli.me/index.php?rest_route=%2Foembed%2F1.0%2Fembed&#038;url=https%3A%2F%2F0xli.me%2F%3Fpage_id%3D710&#038;format=xml" />     <style>         :root {	 	            --wp-meliora-primary-color: #FFBA9D; 	            --wp-meliora-base-font-color: #777777; 	            --wp-meliora-heading-color: #474747; 	             	            --wp-meliora-link-normal-color: #000 ; 	            --wp-meliora-link-hover-color: #FFBA9D ; 			}    </style> 	<style>.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style><link rel="icon" href="./images/limewirelogo-96x96.png" sizes="32x32" /> <link rel="icon" href="./images/limewirelogo-300x300.png" sizes="192x192" /> <link rel="apple-touch-icon" href="https://0xli.me/wp-content/uploads/2021/01/limewirelogo-300x300.png" /> <meta name="msapplication-TileImage" content="https://0xli.me/wp-content/uploads/2021/01/limewirelogo-300x300.png" /> 		<style id="wp-custom-css"> 			.wp-block-image img {     max-width: 100%;     margin-left: auto;     margin-right: auto;     display: block; 		margin-bottom 0px; 		 } .wp-block-image figcaption {     margin-top: 0em; } figure figcaption {     text-align: center; 		font-size: 14px; 		font-weight: lighter; 		color: grey; } code, kbd, samp{ 	color: darkgreen; } 		</style> 		<style id="kirki-inline-styles">.h1,h1{font-family:Roboto Mono;font-size:24px;font-weight:300;line-height:1.5;}.h2,h2{font-size:calc(24px - 0.3125rem);font-weight:300;font-family:Roboto Mono;line-height:1.5;}.h3,h3{font-size:calc(24px - 0.38rem);font-weight:300;font-family:Roboto Mono;}.h4,h4{font-size:calc(24px - 0.44rem);font-weight:300;font-family:Roboto Mono;}.h5,h5{font-size:calc(24px - 0.52rem);font-weight:300;font-family:Roboto Mono;}.h6,h6{font-size:calc(24px - 0.6rem);font-weight:300;font-family:Roboto Mono;}body{font-size:16px;line-height:1.5;font-family:Roboto Mono;}.c-post__content__main a{font-family:Roboto Mono;font-size:16px;font-weight:300;line-height:1.5;}/* cyrillic-ext */ @font-face {   font-family: 'Roboto Mono';   font-style: normal;   font-weight: 300;   font-display: swap;   src: url(./fonts/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_gPq_SeW-AJi8SKQuQ4Y.woff) format('woff');   unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F; } /* cyrillic */ @font-face {   font-family: 'Roboto Mono';   font-style: normal;   font-weight: 300;   font-display: swap;   src: url(./fonts/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_gPq_QOW-AJi8SKQuQ4Y.woff) format('woff');   unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116; } /* greek */ @font-face {   font-family: 'Roboto Mono';   font-style: normal;   font-weight: 300;   font-display: swap;   src: url(./fonts/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_gPq_R-W-AJi8SKQuQ4Y.woff) format('woff');   unicode-range: U+0370-03FF; } /* vietnamese */ @font-face {   font-family: 'Roboto Mono';   font-style: normal;   font-weight: 300;   font-display: swap;   src: url(./fonts/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_gPq_S-W-AJi8SKQuQ4Y.woff) format('woff');   unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+1EA0-1EF9, U+20AB; } /* latin-ext */ @font-face {   font-family: 'Roboto Mono';   font-style: normal;   font-weight: 300;   font-display: swap;   src: url(./fonts/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_gPq_SuW-AJi8SKQuQ4Y.woff) format('woff');   unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF; } /* latin */ @font-face {   font-family: 'Roboto Mono';   font-style: normal;   font-weight: 300;   font-display: swap;   src: url(./fonts/L0xuDF4xlVMF-BfR8bXMIhJHg45mwgGEFl0_gPq_ROW-AJi8SKQu.woff) format('woff');   unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD; }</style></head>  <body class="page-template-default page page-id-710 no-sidebar"> <div id="page" class="o-page site is-content-sidebar">     <a class="skip-link screen-reader-text" href="#primary">Skip to content</a>     <header id="masthead" class="c-header site-header">         <div class="c-header__main u-default-max-width">             <div class="c-header__branding"> 				            <p class="c-header__branding__title site-title h1">                 <a class="c-header__branding__title__link h1" href="https://0xli.me/" rel="home">0xlimE Writeup blog</a>             </p> 		            </div><!-- .site-branding -->              <nav id="site-navigation" class="c-header__navigation main-navigation">                 <button aria-label="Toggle menu" class="c-header__navigation__toggle js-menu-toggle menu-toggle" aria-controls="primary-menu" aria-expanded="false">                     <span class="dashicons dashicons-menu-alt"></span></button> 				<ul id="primary-menu" class="menu js-primary-menu"><li class='menu-item menu-item-type-custom menu-item-object-custom menu-item-home'><a href="https://0xli.me">Home</a></li> <li class='menu-item menu-item-type-post_type menu-item-object-page'><a href="https://0xli.me/?page_id=427">Passwords</a></li> <li class='menu-item menu-item-type-taxonomy menu-item-object-category'><a href="https://0xli.me/?cat=23">HTB Machines</a></li> <li class='menu-item menu-item-type-taxonomy menu-item-object-category'><a href="https://0xli.me/?cat=24">HTB Challenges</a></li> <li class='menu-item menu-item-type-taxonomy menu-item-object-category'><a href="https://0xli.me/?cat=34">CTF</a></li> </ul>            </nav><!-- #site-navigation --> 			        </div>     </header><!-- #masthead -->      <main id="primary" class="site-main">         <div class="site-main__container default-max-width">             <div class="site-main__content"> 				 <article id="post-710" class="c-page post-710 page type-page status-publish hentry">      <header class="c-page__header entry-header"> 		<h1 class="c-page__title entry-title">De Danske Cybermesterskaber Nationals &#8211; Ethereum Haiku</h1>    </header><!-- .entry-header -->      <div class="entry-content"> 		 <p>Ok so I made this challenge with some idea that most people know about blockchain and how it works.<br>boy was I wrong.<br>So sorry if you thought it was uncool that I labeled this as easy, I may have overestimated how much people think the blockchain is super dope.</p>    <p>Let me show you how it was intended for someone to solve.</p>    <p>The challenge presented itself as a small cute haiku, which had all the information you needed to go find the flag</p>    <figure class="wp-block-image size-large"><img loading="lazy" width="516" height="626" src="./images/billede.png" alt="" class="wp-image-711"/><figcaption>Cute haiku right.</figcaption></figure>    <p>So really quick and dirty about blockchain. In most blockchains you have a wallet address, and I have a wallet address, a wallet may contain an amount of <em>Ether</em> (this is the currency), I can send some ether from my address to yours, by submitting a transaction to the blockchain. Imagine the blockchain as just a big folder of ordered excel spreadsheets, where each block is imagined as a single excel spreadsheet, where information about which address transfers ethereum to another, and how many. In ethereum a new block is made every 13th second or so. There are also a thing called <em>smart contracts </em>on the ethereum blockchain, but I won&#8217;t go into this.</p>    <figure class="wp-block-image"><img src="./images/How_Does_Blockchain_work_Inlea_01-e1562018184106.jpg" alt="But… How does Blockchain really works? - Inlea - Blog"/><figcaption>or in some pretty picture</figcaption></figure>    <p>So with some very boiled down blockchain info out of the way, let me tell you my inteded train of thought here.</p>    <p><em>7th of april</em> &#8211; I need to look for blocks on the 7th of april.</p>    <p><em>when I lost my flag</em> &#8211; Ok the flag is on the chain somewhere</p>    <p><em>ropsten oh ropsten</em> &#8211; Ok this dude didnt spend real ethereum, he used the ropsten test network, thats where I should look.</p>    <p>Looking back now I see I may have assumed a shit ton, and I am sorry if you feel you wasted your time on this challenge.</p>    <p>The next thing to do is to find the range of blocks, which are on the 7th of april, since we want to check transactions in this block range, what I did was just go to <a href="https://ropsten.etherscan.io/">https://ropsten.etherscan.io/</a> and binary search the blocks in the browser (hackerman).</p>    <p> So by just pressing a block and then changing the url to go back, you can see that that the 7th of april is about from Block <code>9991000 - 9997000</code>. Cool, so far so good. (https://ropsten.etherscan.io/block/9991000)</p>    <p>Ok so we could either host a ropsten node, and download the full ropsten ethereum blockchain, this is about 150gb, so a little waste of space for finding 1 flag. What you can do instead is just to use a node as a service, and query that.</p>    <p>This may have been tricky to realize, if you are not a blockchain developer (shout out to the like 50 blockchain developers that exist, kidding). So this was obvious a misslabeling of the difficulty.</p>    <p>Anyway, we want to start checking some blocks for that day, so we google around and find a library <em>web3</em> which is used to interact with the eth blockchain (can also be used with eth testnet chains). This short guide should let you get started with blockchain interaction development: https://www.dappuniversity.com/articles/web3-py-intro</p>    <p>As you can see you need an infura account, so go sign up there, its free and then we are basically good to go. The following script will look for <code>4444437b</code> (hex for &#8216;DDC{&#8216;) in the blocks.</p>    <pre class="EnlighterJSRAW" data-enlighter-language="python" data-enlighter-theme="" data-enlighter-highlight="" data-enlighter-linenumbers="" data-enlighter-lineoffset="" data-enlighter-title="" data-enlighter-group="">from web3 import Web3    import json w3 = Web3(Web3.HTTPProvider("https://ropsten.infura.io/v3/********INFURA TOKEN******")) # Better space to search  #blockStart = 9993120 #blockEnd   = 9993126   blockStart = 9991000 blockEnd   = 9997000  for x in range(blockStart,blockEnd):     block = w3.eth.getBlock(x,True)     print("now at block:"+str(x))     if "4444437b" in str(block): #'DDC{' in hex         print(block)         break </pre>    <p>This will of course take around 6k requests to search through the day, but very doable, can be done faster if you are a python3 multithreading shark, I&#8217;m not.</p>    <figure class="wp-block-image size-full"><img loading="lazy" width="1217" height="696" src="./images/iD9voxp96n.gif" alt="" class="wp-image-719"/><figcaption>searching for around 5 minutes</figcaption></figure>    <p>and then grep through the output to find the string.</p>    <figure class="wp-block-image size-large"><img loading="lazy" width="1024" height="692" src="./images/billede-1-1024x692.png" alt="" class="wp-image-721"/><figcaption>grep through the output</figcaption></figure>    <p>Pop it into something that decodes from hex</p>    <figure class="wp-block-image size-large"><img loading="lazy" width="815" height="702" src="./images/billede-2.png" alt="" class="wp-image-722"/><figcaption>flag finally</figcaption></figure>    <p>If you had to mindlessly scroll through etherscan, this is the transaction you should have found</p>    <p><a href="https://ropsten.etherscan.io/tx/0x33bef607ddb05fbaed097868ba302a96943b15d785ef63c2b91a3a59c966bf1f">https://ropsten.etherscan.io/tx/0x33bef607ddb05fbaed097868ba302a96943b15d785ef63c2b91a3a59c966bf1f</a></p>    <p>Ok was this an easy challenge? No, was it simple? yes, if you could read my mind. Was anyone close? Yes I talked to 1 guy, but he thought it was infeasible requesting 1000+ blocks. </p>    <p>I am sorry if this challenge frustrated you, but I urge you to learn more about ethereum, its really cool</p>    <p>Peace out!</p>    <figure class="wp-block-image size-large"><img loading="lazy" width="345" height="345" src="./images/Unavngivet.png" alt="" class="wp-image-634" srcset="./images/Unavngivet.png 345w, ./images/Unavngivet-300x300.png 300w, ./images/Unavngivet-150x150.png 150w" sizes="(max-width: 345px) 100vw, 345px" /></figure>     </div><!-- .entry-content -->  	</article><!-- #post-710 -->             </div> 	                </div>     </main><!-- #main -->   <footer id="colophon" class="c-footer site-footer">     <div class="c-footer__top">         <div class="c-footer__top__back-to-top">             <a aria-label="Back to Top" class="c-footer__top__back-to-top__link" href="#masthead">                 <span class="dashicons dashicons-arrow-up-alt2"></span>             </a>         </div>     </div>     <div class="c-footer__bottom site-info">         <div class="u-default-max-width">             <div class="c-footer__grid">                 <div class="c-footer__copyright"> 	                                        <div class="c-footer__branding s-footer-branding">                                         <a class="c-footer__branding__title h1" href="https://0xli.me/" rel="home">0xlimE Writeup blog</a> 		                        </div> 	                                    <p> 					                    </p>                 </div>                             </div>         </div><!-- .site-info -->     </div> </footer><!-- #colophon -->  </div><!-- #page -->  <script src='./js/wp-meliora-js-navigation.js' id='wp_meliora-navigation-js'></script> <script src='./js/wp-meliora-js-vendor.min.js' id='wp_meliora-carousel-js'></script> <script src='./js/wp-meliora-js-main.js' id='wp_meliora-main-js'></script> <script src='./js/enlighter-cache-enlighterjs.min.js' id='enlighterjs-js'></script> <script id='enlighterjs-js-after'>
!function(e,n){if("undefined"!=typeof EnlighterJS){var o={"selectors":{"block":"pre.EnlighterJSRAW","inline":"code.EnlighterJSRAW"},"options":{"indent":4,"ampersandCleanup":true,"linehover":true,"rawcodeDbclick":false,"textOverflow":"scroll","linenumbers":true,"theme":"enlighter","language":"generic","retainCssClasses":false,"collapse":false,"toolbarOuter":"","toolbarTop":"{BTN_RAW}{BTN_COPY}{BTN_WINDOW}{BTN_WEBSITE}","toolbarBottom":""}};(e.EnlighterJSINIT=function(){EnlighterJS.init(o.selectors.block,o.selectors.inline,o.options)})()}else{(n&&(n.error||n.log)||function(){})("Error: EnlighterJS resources not loaded yet!")}}(window,console);
</script> <script src='./js/cpd-wp-embed.min.js' id='wp-embed-js'></script>  </body> </html>